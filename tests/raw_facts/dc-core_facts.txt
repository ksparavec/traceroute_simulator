# Traceroute Simulator Facts Collection
# Generated on: 2025-06-21 15:21:17
# Hostname: dc-core
# Kernel: 5.15.0-85-generic
# Collection Script Version: 1.0

# Locating required commands in standard paths
# Found commands:
# IP: /sbin/ip
# IPTABLES: /sbin/iptables
# IPTABLES-SAVE: /sbin/iptables-save
# IPSET: /sbin/ipset
# LSMOD: /bin/lsmod
# Running as root: 1

=== TSIM_SECTION_START:routing_table ===
TITLE: IP Routing Table
COMMAND: /sbin/ip route show
TIMESTAMP: 2025-06-21 15:21:17
---
default via 10.3.1.1 dev eth0 metric 1
10.3.1.0/24 dev eth0 proto kernel scope link src 10.3.1.2
10.3.2.0/24 dev eth1 proto kernel scope link src 10.3.2.1
10.3.10.0/24 via 10.3.2.3 dev eth1 metric 1
10.3.20.0/24 via 10.3.2.3 dev eth1 metric 1
10.3.21.0/24 via 10.3.2.3 dev eth1 metric 1
10.1.0.0/16 via 10.3.1.1 dev eth0 metric 10
10.2.0.0/16 via 10.3.1.1 dev eth0 metric 10
192.0.2.0/24 via 10.3.1.1 dev eth0 metric 1
198.51.100.0/24 via 10.3.1.1 dev eth0 metric 1
203.0.113.0/24 via 10.3.1.1 dev eth0 metric 1

EXIT_CODE: 0
=== TSIM_SECTION_END:routing_table ===

=== TSIM_SECTION_START:policy_rules ===
TITLE: IP Policy Rules
COMMAND: /sbin/ip rule show
TIMESTAMP: 2025-07-01 10:00:00
---
0:	from all lookup local
50:	from 10.3.1.0/24 lookup priority_table
51:	from 10.3.2.0/24 lookup priority_table
52:	from 10.3.10.0/24 lookup priority_table
53:	from 10.3.20.0/24 lookup priority_table
54:	from 10.3.20.0/24 lookup management_table
55:	dport 3306 lookup database_table
56:	dport 5432 lookup database_table
57:	sport 3306 lookup database_table
58:	dport 80 lookup web_table
59:	dport 443 lookup web_table
60:	sport 80 lookup web_table
61:	dport 22 lookup priority_table
62:	dport 161 lookup priority_table
63:	dport 443 lookup priority_table
64:	fwmark 0x1 lookup priority_table
65:	fwmark 0x2 lookup service_table
66:	fwmark 0x3 lookup backup_table
67:	tos 0x10 lookup priority_table
68:	tos 0x08 lookup qos_table
69:	to 10.1.0.0/16 lookup service_table
70:	to 10.2.0.0/16 lookup service_table
71:	iif lo lookup priority_table
72:	oif eth1 lookup service_table
73:	oif eth2 lookup backup_table
74:	from 192.168.1.0/24 lookup emergency_table
75:	ipproto icmp lookup priority_table
76:	ipproto udp lookup qos_table
32766:	from all lookup main
32767:	from all lookup default

EXIT_CODE: 0
=== TSIM_SECTION_END:policy_rules ===


=== TSIM_SECTION_START:routing_table_priority_table ===
TITLE: IP Routing Table Priority Table (100)
COMMAND: /sbin/ip route show table 100
TIMESTAMP: 2025-07-01 10:00:00
---
10.3.1.0/24 dev eth1 proto kernel scope link metric 1
10.3.2.0/24 dev eth0 proto kernel scope link metric 1
10.3.10.0/24 dev eth0 proto kernel scope link metric 1
10.3.20.0/24 dev eth0 proto kernel scope link metric 1
10.1.0.0/16 via 10.3.1.1 dev eth0 metric 5
10.2.0.0/16 via 10.3.1.1 dev eth0 metric 5

EXIT_CODE: 0
=== TSIM_SECTION_END:routing_table_priority_table ===


=== TSIM_SECTION_START:routing_table_service_table ===
TITLE: IP Routing Table Service Table (200)
COMMAND: /sbin/ip route show table 200
TIMESTAMP: 2025-07-01 10:00:00
---
10.3.1.0/24 dev eth1 proto kernel scope link metric 10
10.3.2.0/24 dev eth1 proto kernel scope link metric 10
10.3.10.0/24 dev eth1 proto kernel scope link metric 10
10.3.20.0/24 dev eth1 proto kernel scope link metric 10
10.3.20.0/24 dev eth2 proto kernel scope link metric 5
10.1.0.0/16 via 10.3.1.1 dev eth0 metric 15
10.2.0.0/16 via 10.3.1.1 dev eth0 metric 15

EXIT_CODE: 0
=== TSIM_SECTION_END:routing_table_service_table ===


=== TSIM_SECTION_START:routing_table_backup_table ===
TITLE: IP Routing Table Backup Table (300)
COMMAND: /sbin/ip route show table 300
TIMESTAMP: 2025-07-01 10:00:00
---
10.3.1.0/24 dev eth1 proto kernel scope link metric 20
10.3.2.0/24 dev eth1 proto kernel scope link metric 20
10.3.10.0/24 dev eth1 proto kernel scope link metric 20
10.3.20.0/24 dev eth1 proto kernel scope link metric 20
10.1.0.0/16 via 10.100.1.1 dev wg0 metric 25
10.2.0.0/16 via 10.100.1.2 dev wg0 metric 25

EXIT_CODE: 0
=== TSIM_SECTION_END:routing_table_backup_table ===


=== TSIM_SECTION_START:routing_table_qos_table ===
TITLE: IP Routing Table Qos Table (400)
COMMAND: /sbin/ip route show table 400
TIMESTAMP: 2025-07-01 10:00:00
---
10.3.1.0/24 dev eth1 proto kernel scope link metric 8
10.3.2.0/24 dev eth1 proto kernel scope link metric 8
10.3.10.0/24 dev eth1 proto kernel scope link metric 8
10.3.20.0/24 dev eth1 proto kernel scope link metric 8
10.1.0.0/16 via 10.3.1.1 dev eth0 metric 8
10.2.0.0/16 via 10.3.1.1 dev eth0 metric 8

EXIT_CODE: 0
=== TSIM_SECTION_END:routing_table_qos_table ===


=== TSIM_SECTION_START:routing_table_management_table ===
TITLE: IP Routing Table Management Table (500)
COMMAND: /sbin/ip route show table 500
TIMESTAMP: 2025-07-01 10:00:00
---
10.3.1.0/24 dev eth0 proto kernel scope link metric 1
10.3.2.0/24 dev eth0 proto kernel scope link metric 1
10.3.10.0/24 dev eth0 proto kernel scope link metric 1
10.3.20.0/24 dev eth0 proto kernel scope link metric 1
10.3.20.0/24 dev eth2 proto kernel scope link metric 1
10.1.0.0/16 via 10.3.1.1 dev eth0 metric 5
10.2.0.0/16 via 10.3.1.1 dev eth0 metric 5

EXIT_CODE: 0
=== TSIM_SECTION_END:routing_table_management_table ===


=== TSIM_SECTION_START:routing_table_database_table ===
TITLE: IP Routing Table Database Table (600)
COMMAND: /sbin/ip route show table 600
TIMESTAMP: 2025-07-01 10:00:00
---
10.3.20.0/24 dev eth2 proto kernel scope link metric 1
10.3.10.0/24 dev eth1 proto kernel scope link metric 1
10.1.0.0/16 via 10.3.1.1 dev eth0 metric 5
10.2.0.0/16 via 10.3.1.1 dev eth0 metric 10
10.3.1.0/24 dev eth1 proto kernel scope link metric 5
10.3.2.0/24 dev eth1 proto kernel scope link metric 5
10.3.10.0/24 dev eth1 proto kernel scope link metric 5
10.3.20.0/24 dev eth1 proto kernel scope link metric 5

EXIT_CODE: 0
=== TSIM_SECTION_END:routing_table_database_table ===


=== TSIM_SECTION_START:routing_table_web_table ===
TITLE: IP Routing Table Web Table (700)
COMMAND: /sbin/ip route show table 700
TIMESTAMP: 2025-07-01 10:00:00
---
10.3.2.0/24 dev eth0 proto kernel scope link metric 1
10.3.1.0/24 dev eth1 proto kernel scope link metric 5
10.3.2.0/24 dev eth1 proto kernel scope link metric 5
10.3.10.0/24 dev eth1 proto kernel scope link metric 5
10.3.20.0/24 dev eth1 proto kernel scope link metric 5

EXIT_CODE: 0
=== TSIM_SECTION_END:routing_table_web_table ===


=== TSIM_SECTION_START:routing_table_emergency_table ===
TITLE: IP Routing Table Emergency Table (800)
COMMAND: /sbin/ip route show table 800
TIMESTAMP: 2025-07-01 10:00:00
---
192.168.1.0/24 dev eth0 proto kernel scope link metric 1
10.3.1.0/24 dev eth1 proto kernel scope link metric 1
10.3.2.0/24 dev eth1 proto kernel scope link metric 1
10.3.10.0/24 dev eth1 proto kernel scope link metric 1
10.3.20.0/24 dev eth1 proto kernel scope link metric 1

EXIT_CODE: 0
=== TSIM_SECTION_END:routing_table_emergency_table ===

=== TSIM_SECTION_START:interfaces ===
TITLE: Network Interfaces
COMMAND: /sbin/ip addr show
TIMESTAMP: 2025-06-21 15:21:17
---
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 52:54:00:72:34:01 brd ff:ff:ff:ff:ff:ff
    inet 10.3.1.2/24 brd 10.3.1.255 scope global eth0
       valid_lft forever preferred_lft forever
3: eth1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 52:54:00:72:34:02 brd ff:ff:ff:ff:ff:ff
    inet 10.3.2.1/24 brd 10.3.2.255 scope global eth1
       valid_lft forever preferred_lft forever

EXIT_CODE: 0
=== TSIM_SECTION_END:interfaces ===

=== TSIM_SECTION_START:interface_stats ===
TITLE: Interface Statistics
COMMAND: cat /proc/net/dev
TIMESTAMP: 2025-06-21 15:21:17
---
Inter-|   Receive                                                |  Transmit
 face |bytes    packets errs drop fifo frame compressed multicast|bytes    packets errs drop fifo colls carrier compressed
    lo:   54321      543    0    0    0     0          0         0    54321      543    0    0    0     0       0          0
  eth0:15432109    15432    0    0    0     0          0         0 14321098    14321    0    0    0     0       0          0
  eth1:13210987    13210    0    0    0     0          0         0 12109876    12109    0    0    0     0       0          0
  eth2:10987654    10987    0    0    0     0          0         0  9876543     9876    0    0    0     0       0          0
  eth3: 8765432     8765    0    0    0     0          0         0  7654321     7654    0    0    0     0       0          0
  eth4: 6543210     6543    0    0    0     0          0         0  5432109     5432    0    0    0     0       0          0

EXIT_CODE: 0
=== TSIM_SECTION_END:interface_stats ===

=== TSIM_SECTION_START:ip_forwarding ===
TITLE: IP Forwarding Status
COMMAND: cat /proc/sys/net/ipv4/ip_forward
TIMESTAMP: 2025-06-21 15:21:17
---
1

EXIT_CODE: 0
=== TSIM_SECTION_END:ip_forwarding ===

=== TSIM_SECTION_START:kernel_version ===
TITLE: Kernel Version
COMMAND: uname -r
TIMESTAMP: 2025-06-21 15:21:17
---
5.15.0-85-generic

EXIT_CODE: 0
=== TSIM_SECTION_END:kernel_version ===

=== TSIM_SECTION_START:loaded_modules ===
TITLE: Loaded Kernel Modules
COMMAND: /bin/lsmod
TIMESTAMP: 2025-06-21 15:21:17
---
Module                  Size  Used by
xt_REDIRECT            16384  0
xt_NETMAP              16384  0
xt_conntrack           16384  12
xt_CHECKSUM            16384  0
xt_CLASSIFY            16384  8
xt_DSCP                16384  6
xt_MARK                16384  4
xt_LOG                 16384  10
xt_limit               16384  16
xt_multiport           16384  14
xt_recent              16384  8
xt_set                 16384  24
xt_state               16384  8
xt_statistic           16384  4
xt_string              16384  8
xt_tcpudp              16384  18
xt_time                16384  12
xt_u32                 16384  6
ipt_MASQUERADE         16384  0
ipt_REJECT             16384  12
ipt_ULOG               16384  0
ip_set                 49152  1 xt_set
ip_set_hash_net        16384  1
ip_set_hash_ip         16384  1
ip_set_hash_netport    16384  1
ip_set_hash_ipport     16384  1
ip_set_hash_netnet     16384  1
ip_set_hash_ipportnet  16384  1
ip_set_hash_ipportproto 16384  1
ip_set_hash_netnetport 16384  1
ip_set_hash_ipmark     16384  1
ip_set_list_set        16384  1
ip_set_bitmap_port     16384  1
ip_set_bitmap_ip       16384  1
ip_tables              32768  0
x_tables               40960  24 xt_REDIRECT,xt_NETMAP,xt_conntrack,xt_CHECKSUM,xt_CLASSIFY,xt_DSCP,xt_MARK,xt_LOG,xt_limit,xt_multiport,xt_recent,xt_set,xt_state,xt_statistic,xt_string,xt_tcpudp,xt_time,xt_u32,ipt_MASQUERADE,ipt_REJECT,ipt_ULOG
nf_conntrack           139264  8 xt_conntrack,xt_state,ipt_MASQUERADE,nf_nat
nf_nat                 40960  1 ipt_MASQUERADE
nf_defrag_ipv4         16384  1 nf_conntrack
nf_defrag_ipv6         24576  1 nf_conntrack

EXIT_CODE: 0
=== TSIM_SECTION_END:loaded_modules ===

=== TSIM_SECTION_START:conntrack_info ===
TITLE: Connection Tracking Information
COMMAND: cat /proc/sys/net/nf_conntrack_max
TIMESTAMP: 2025-06-21 15:21:17
---
524288

EXIT_CODE: 0
=== TSIM_SECTION_END:conntrack_info ===

=== TSIM_SECTION_START:iptables_info ===
TITLE: Iptables Information
COMMAND: /sbin/iptables --version
TIMESTAMP: 2025-06-21 15:21:17
---
iptables v1.8.7 (nf_tables)

EXIT_CODE: 0
=== TSIM_SECTION_END:iptables_info ===

=== TSIM_SECTION_START:iptables_save ===
TITLE: Iptables Save Output
COMMAND: /sbin/iptables-save
TIMESTAMP: 2025-07-01 10:00:00
---
# Generated by iptables-save v1.8.7 on Mon Jul  1 10:00:00 2025
*filter
:INPUT DROP [0:0]
:FORWARD DROP [0:0]
:OUTPUT ACCEPT [0:0]
:ALLOW_BASIC_TRAFFIC - [0:0]
:DC_CORE_MGMT_ACCESS - [0:0]
:DC_CORE_LAN_FORWARD - [0:0]
-A INPUT -j ALLOW_BASIC_TRAFFIC
-A INPUT -i lo -j ACCEPT
-A INPUT -m conntrack --ctstate INVALID -j DROP
-A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A INPUT -s 10.1.0.0/16 -p icmp --icmp-type 0 -j LOG --log-prefix "INPUT-ICMP-0: "
-A INPUT -s 10.1.0.0/16 -p icmp --icmp-type 0 -j ACCEPT
-A INPUT -s 10.1.0.0/16 -p icmp --icmp-type 3 -j LOG --log-prefix "INPUT-ICMP-3: "
-A INPUT -s 10.1.0.0/16 -p icmp --icmp-type 3 -j ACCEPT
-A INPUT -s 10.1.0.0/16 -p icmp --icmp-type 8 -j LOG --log-prefix "INPUT-ICMP-8: "
-A INPUT -s 10.1.0.0/16 -p icmp --icmp-type 8 -j ACCEPT
-A INPUT -s 10.1.0.0/16 -p icmp --icmp-type 11 -j LOG --log-prefix "INPUT-ICMP-11: "
-A INPUT -s 10.1.0.0/16 -p icmp --icmp-type 11 -j ACCEPT
-A INPUT -s 10.2.0.0/16 -p icmp --icmp-type 0 -j LOG --log-prefix "INPUT-ICMP-0: "
-A INPUT -s 10.2.0.0/16 -p icmp --icmp-type 0 -j ACCEPT
-A INPUT -s 10.2.0.0/16 -p icmp --icmp-type 3 -j LOG --log-prefix "INPUT-ICMP-3: "
-A INPUT -s 10.2.0.0/16 -p icmp --icmp-type 3 -j ACCEPT
-A INPUT -s 10.2.0.0/16 -p icmp --icmp-type 8 -j LOG --log-prefix "INPUT-ICMP-8: "
-A INPUT -s 10.2.0.0/16 -p icmp --icmp-type 8 -j ACCEPT
-A INPUT -s 10.2.0.0/16 -p icmp --icmp-type 11 -j LOG --log-prefix "INPUT-ICMP-11: "
-A INPUT -s 10.2.0.0/16 -p icmp --icmp-type 11 -j ACCEPT
-A INPUT -s 10.3.0.0/16 -p icmp --icmp-type 0 -j LOG --log-prefix "INPUT-ICMP-0: "
-A INPUT -s 10.3.0.0/16 -p icmp --icmp-type 0 -j ACCEPT
-A INPUT -s 10.3.0.0/16 -p icmp --icmp-type 3 -j LOG --log-prefix "INPUT-ICMP-3: "
-A INPUT -s 10.3.0.0/16 -p icmp --icmp-type 3 -j ACCEPT
-A INPUT -s 10.3.0.0/16 -p icmp --icmp-type 8 -j LOG --log-prefix "INPUT-ICMP-8: "
-A INPUT -s 10.3.0.0/16 -p icmp --icmp-type 8 -j ACCEPT
-A INPUT -s 10.3.0.0/16 -p icmp --icmp-type 11 -j LOG --log-prefix "INPUT-ICMP-11: "
-A INPUT -s 10.3.0.0/16 -p icmp --icmp-type 11 -j ACCEPT
-A INPUT -s 10.100.1.0/24 -p icmp --icmp-type 0 -j LOG --log-prefix "INPUT-ICMP-0: "
-A INPUT -s 10.100.1.0/24 -p icmp --icmp-type 0 -j ACCEPT
-A INPUT -s 10.100.1.0/24 -p icmp --icmp-type 3 -j LOG --log-prefix "INPUT-ICMP-3: "
-A INPUT -s 10.100.1.0/24 -p icmp --icmp-type 3 -j ACCEPT
-A INPUT -s 10.100.1.0/24 -p icmp --icmp-type 8 -j LOG --log-prefix "INPUT-ICMP-8: "
-A INPUT -s 10.100.1.0/24 -p icmp --icmp-type 8 -j ACCEPT
-A INPUT -s 10.100.1.0/24 -p icmp --icmp-type 11 -j LOG --log-prefix "INPUT-ICMP-11: "
-A INPUT -s 10.100.1.0/24 -p icmp --icmp-type 11 -j ACCEPT
-A INPUT -s 10.1.0.0/16 -p tcp --dport 22 -m conntrack --ctstate NEW -j LOG --log-prefix "INPUT-MGMT-22: "
-A INPUT -s 10.1.0.0/16 -p tcp --dport 22 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -s 10.1.0.0/16 -p tcp --dport 161 -m conntrack --ctstate NEW -j LOG --log-prefix "INPUT-MGMT-161: "
-A INPUT -s 10.1.0.0/16 -p tcp --dport 161 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -s 10.1.0.0/16 -p tcp --dport 443 -m conntrack --ctstate NEW -j LOG --log-prefix "INPUT-MGMT-443: "
-A INPUT -s 10.1.0.0/16 -p tcp --dport 443 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -s 10.1.0.0/16 -p tcp --dport 8080 -m conntrack --ctstate NEW -j LOG --log-prefix "INPUT-MGMT-8080: "
-A INPUT -s 10.1.0.0/16 -p tcp --dport 8080 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -s 10.1.0.0/16 -p tcp --dport 514 -m conntrack --ctstate NEW -j LOG --log-prefix "INPUT-MGMT-514: "
-A INPUT -s 10.1.0.0/16 -p tcp --dport 514 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -s 10.2.0.0/16 -p tcp --dport 22 -m conntrack --ctstate NEW -j LOG --log-prefix "INPUT-MGMT-22: "
-A INPUT -s 10.2.0.0/16 -p tcp --dport 22 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -s 10.2.0.0/16 -p tcp --dport 161 -m conntrack --ctstate NEW -j LOG --log-prefix "INPUT-MGMT-161: "
-A INPUT -s 10.2.0.0/16 -p tcp --dport 161 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -s 10.2.0.0/16 -p tcp --dport 443 -m conntrack --ctstate NEW -j LOG --log-prefix "INPUT-MGMT-443: "
-A INPUT -s 10.2.0.0/16 -p tcp --dport 443 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -s 10.2.0.0/16 -p tcp --dport 8080 -m conntrack --ctstate NEW -j LOG --log-prefix "INPUT-MGMT-8080: "
-A INPUT -s 10.2.0.0/16 -p tcp --dport 8080 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -s 10.2.0.0/16 -p tcp --dport 514 -m conntrack --ctstate NEW -j LOG --log-prefix "INPUT-MGMT-514: "
-A INPUT -s 10.2.0.0/16 -p tcp --dport 514 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -s 10.3.0.0/16 -p tcp --dport 22 -m conntrack --ctstate NEW -j LOG --log-prefix "INPUT-MGMT-22: "
-A INPUT -s 10.3.0.0/16 -p tcp --dport 22 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -s 10.3.0.0/16 -p tcp --dport 161 -m conntrack --ctstate NEW -j LOG --log-prefix "INPUT-MGMT-161: "
-A INPUT -s 10.3.0.0/16 -p tcp --dport 161 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -s 10.3.0.0/16 -p tcp --dport 443 -m conntrack --ctstate NEW -j LOG --log-prefix "INPUT-MGMT-443: "
-A INPUT -s 10.3.0.0/16 -p tcp --dport 443 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -s 10.3.0.0/16 -p tcp --dport 8080 -m conntrack --ctstate NEW -j LOG --log-prefix "INPUT-MGMT-8080: "
-A INPUT -s 10.3.0.0/16 -p tcp --dport 8080 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -s 10.3.0.0/16 -p tcp --dport 514 -m conntrack --ctstate NEW -j LOG --log-prefix "INPUT-MGMT-514: "
-A INPUT -s 10.3.0.0/16 -p tcp --dport 514 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -s 10.100.1.0/24 -p tcp --dport 22 -m conntrack --ctstate NEW -j LOG --log-prefix "INPUT-MGMT-22: "
-A INPUT -s 10.100.1.0/24 -p tcp --dport 22 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -s 10.100.1.0/24 -p tcp --dport 161 -m conntrack --ctstate NEW -j LOG --log-prefix "INPUT-MGMT-161: "
-A INPUT -s 10.100.1.0/24 -p tcp --dport 161 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -s 10.100.1.0/24 -p tcp --dport 443 -m conntrack --ctstate NEW -j LOG --log-prefix "INPUT-MGMT-443: "
-A INPUT -s 10.100.1.0/24 -p tcp --dport 443 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -s 10.100.1.0/24 -p tcp --dport 8080 -m conntrack --ctstate NEW -j LOG --log-prefix "INPUT-MGMT-8080: "
-A INPUT -s 10.100.1.0/24 -p tcp --dport 8080 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -s 10.100.1.0/24 -p tcp --dport 514 -m conntrack --ctstate NEW -j LOG --log-prefix "INPUT-MGMT-514: "
-A INPUT -s 10.100.1.0/24 -p tcp --dport 514 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -s 10.1.0.0/16 -p udp --dport 33434:33534 -j LOG --log-prefix "INPUT-MTR-UDP: "
-A INPUT -s 10.1.0.0/16 -p udp --dport 33434:33534 -j ACCEPT
-A INPUT -s 10.2.0.0/16 -p udp --dport 33434:33534 -j LOG --log-prefix "INPUT-MTR-UDP: "
-A INPUT -s 10.2.0.0/16 -p udp --dport 33434:33534 -j ACCEPT
-A INPUT -s 10.3.0.0/16 -p udp --dport 33434:33534 -j LOG --log-prefix "INPUT-MTR-UDP: "
-A INPUT -s 10.3.0.0/16 -p udp --dport 33434:33534 -j ACCEPT
-A INPUT -s 10.100.1.0/24 -p udp --dport 33434:33534 -j LOG --log-prefix "INPUT-MTR-UDP: "
-A INPUT -s 10.100.1.0/24 -p udp --dport 33434:33534 -j ACCEPT
-A INPUT -j LOG --log-prefix "INPUT-DROP: "
-A INPUT -j DROP
-A FORWARD -j ALLOW_BASIC_TRAFFIC
-A FORWARD -i lo -j ACCEPT
-A FORWARD -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A FORWARD -s 10.1.0.0/16 -d 10.2.0.0/16 -p icmp -j LOG --log-prefix "FWD-ICMP-10_1_0_0-10_2_0_0: "
-A FORWARD -s 10.1.0.0/16 -d 10.2.0.0/16 -p icmp -j ACCEPT
-A FORWARD -s 10.1.0.0/16 -d 10.3.0.0/16 -p icmp -j LOG --log-prefix "FWD-ICMP-10_1_0_0-10_3_0_0: "
-A FORWARD -s 10.1.0.0/16 -d 10.3.0.0/16 -p icmp -j ACCEPT
-A FORWARD -s 10.1.0.0/16 -d 10.100.1.0/24 -p icmp -j LOG --log-prefix "FWD-ICMP-10_1_0_0-10_100_1_0: "
-A FORWARD -s 10.1.0.0/16 -d 10.100.1.0/24 -p icmp -j ACCEPT
-A FORWARD -s 10.2.0.0/16 -d 10.1.0.0/16 -p icmp -j LOG --log-prefix "FWD-ICMP-10_2_0_0-10_1_0_0: "
-A FORWARD -s 10.2.0.0/16 -d 10.1.0.0/16 -p icmp -j ACCEPT
-A FORWARD -s 10.2.0.0/16 -d 10.3.0.0/16 -p icmp -j LOG --log-prefix "FWD-ICMP-10_2_0_0-10_3_0_0: "
-A FORWARD -s 10.2.0.0/16 -d 10.3.0.0/16 -p icmp -j ACCEPT
-A FORWARD -s 10.2.0.0/16 -d 10.100.1.0/24 -p icmp -j LOG --log-prefix "FWD-ICMP-10_2_0_0-10_100_1_0: "
-A FORWARD -s 10.2.0.0/16 -d 10.100.1.0/24 -p icmp -j ACCEPT
-A FORWARD -s 10.3.0.0/16 -d 10.1.0.0/16 -p icmp -j LOG --log-prefix "FWD-ICMP-10_3_0_0-10_1_0_0: "
-A FORWARD -s 10.3.0.0/16 -d 10.1.0.0/16 -p icmp -j ACCEPT
-A FORWARD -s 10.3.0.0/16 -d 10.2.0.0/16 -p icmp -j LOG --log-prefix "FWD-ICMP-10_3_0_0-10_2_0_0: "
-A FORWARD -s 10.3.0.0/16 -d 10.2.0.0/16 -p icmp -j ACCEPT
-A FORWARD -s 10.3.0.0/16 -d 10.100.1.0/24 -p icmp -j LOG --log-prefix "FWD-ICMP-10_3_0_0-10_100_1_0: "
-A FORWARD -s 10.3.0.0/16 -d 10.100.1.0/24 -p icmp -j ACCEPT
-A FORWARD -s 10.100.1.0/24 -d 10.1.0.0/16 -p icmp -j LOG --log-prefix "FWD-ICMP-10_100_1_0-10_1_0_0: "
-A FORWARD -s 10.100.1.0/24 -d 10.1.0.0/16 -p icmp -j ACCEPT
-A FORWARD -s 10.100.1.0/24 -d 10.2.0.0/16 -p icmp -j LOG --log-prefix "FWD-ICMP-10_100_1_0-10_2_0_0: "
-A FORWARD -s 10.100.1.0/24 -d 10.2.0.0/16 -p icmp -j ACCEPT
-A FORWARD -s 10.100.1.0/24 -d 10.3.0.0/16 -p icmp -j LOG --log-prefix "FWD-ICMP-10_100_1_0-10_3_0_0: "
-A FORWARD -s 10.100.1.0/24 -d 10.3.0.0/16 -p icmp -j ACCEPT
-A FORWARD -s 10.1.0.0/16 -d 10.2.0.0/16 -p udp --dport 33434:33534 -j LOG --log-prefix "FWD-MTR-10_1_0_0-10_2_0_0: "
-A FORWARD -s 10.1.0.0/16 -d 10.2.0.0/16 -p udp --dport 33434:33534 -j ACCEPT
-A FORWARD -s 10.1.0.0/16 -d 10.3.0.0/16 -p udp --dport 33434:33534 -j LOG --log-prefix "FWD-MTR-10_1_0_0-10_3_0_0: "
-A FORWARD -s 10.1.0.0/16 -d 10.3.0.0/16 -p udp --dport 33434:33534 -j ACCEPT
-A FORWARD -s 10.1.0.0/16 -d 10.100.1.0/24 -p udp --dport 33434:33534 -j LOG --log-prefix "FWD-MTR-10_1_0_0-10_100_1_0: "
-A FORWARD -s 10.1.0.0/16 -d 10.100.1.0/24 -p udp --dport 33434:33534 -j ACCEPT
-A FORWARD -s 10.2.0.0/16 -d 10.1.0.0/16 -p udp --dport 33434:33534 -j LOG --log-prefix "FWD-MTR-10_2_0_0-10_1_0_0: "
-A FORWARD -s 10.2.0.0/16 -d 10.1.0.0/16 -p udp --dport 33434:33534 -j ACCEPT
-A FORWARD -s 10.2.0.0/16 -d 10.3.0.0/16 -p udp --dport 33434:33534 -j LOG --log-prefix "FWD-MTR-10_2_0_0-10_3_0_0: "
-A FORWARD -s 10.2.0.0/16 -d 10.3.0.0/16 -p udp --dport 33434:33534 -j ACCEPT
-A FORWARD -s 10.2.0.0/16 -d 10.100.1.0/24 -p udp --dport 33434:33534 -j LOG --log-prefix "FWD-MTR-10_2_0_0-10_100_1_0: "
-A FORWARD -s 10.2.0.0/16 -d 10.100.1.0/24 -p udp --dport 33434:33534 -j ACCEPT
-A FORWARD -s 10.3.0.0/16 -d 10.1.0.0/16 -p udp --dport 33434:33534 -j LOG --log-prefix "FWD-MTR-10_3_0_0-10_1_0_0: "
-A FORWARD -s 10.3.0.0/16 -d 10.1.0.0/16 -p udp --dport 33434:33534 -j ACCEPT
-A FORWARD -s 10.3.0.0/16 -d 10.2.0.0/16 -p udp --dport 33434:33534 -j LOG --log-prefix "FWD-MTR-10_3_0_0-10_2_0_0: "
-A FORWARD -s 10.3.0.0/16 -d 10.2.0.0/16 -p udp --dport 33434:33534 -j ACCEPT
-A FORWARD -s 10.3.0.0/16 -d 10.100.1.0/24 -p udp --dport 33434:33534 -j LOG --log-prefix "FWD-MTR-10_3_0_0-10_100_1_0: "
-A FORWARD -s 10.3.0.0/16 -d 10.100.1.0/24 -p udp --dport 33434:33534 -j ACCEPT
-A FORWARD -s 10.100.1.0/24 -d 10.1.0.0/16 -p udp --dport 33434:33534 -j LOG --log-prefix "FWD-MTR-10_100_1_0-10_1_0_0: "
-A FORWARD -s 10.100.1.0/24 -d 10.1.0.0/16 -p udp --dport 33434:33534 -j ACCEPT
-A FORWARD -s 10.100.1.0/24 -d 10.2.0.0/16 -p udp --dport 33434:33534 -j LOG --log-prefix "FWD-MTR-10_100_1_0-10_2_0_0: "
-A FORWARD -s 10.100.1.0/24 -d 10.2.0.0/16 -p udp --dport 33434:33534 -j ACCEPT
-A FORWARD -s 10.100.1.0/24 -d 10.3.0.0/16 -p udp --dport 33434:33534 -j LOG --log-prefix "FWD-MTR-10_100_1_0-10_3_0_0: "
-A FORWARD -s 10.100.1.0/24 -d 10.3.0.0/16 -p udp --dport 33434:33534 -j ACCEPT
-A FORWARD -j LOG --log-prefix "FORWARD-DROP: "
-A FORWARD -j DROP
-A ALLOW_BASIC_TRAFFIC -p icmp -j LOG --log-prefix "ALLOW-ICMP: "
-A ALLOW_BASIC_TRAFFIC -p icmp -j ACCEPT
-A ALLOW_BASIC_TRAFFIC -p tcp --dport 10000 -j LOG --log-prefix "ALLOW-TCP-10000: "
-A ALLOW_BASIC_TRAFFIC -p tcp --dport 10000 -j ACCEPT
-A ALLOW_BASIC_TRAFFIC -p udp --dport 10000 -j LOG --log-prefix "ALLOW-UDP-10000: "
-A ALLOW_BASIC_TRAFFIC -p udp --dport 10000 -j ACCEPT
-A ALLOW_BASIC_TRAFFIC -j RETURN
COMMIT
# Completed on Mon Jul  1 10:00:00 2025
# Generated by iptables-save v1.8.7 on Mon Jul  1 10:00:00 2025
*nat
:PREROUTING ACCEPT [0:0]
:INPUT ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:POSTROUTING ACCEPT [0:0]
COMMIT
# Completed on Mon Jul  1 10:00:00 2025
# Generated by iptables-save v1.8.7 on Mon Jul  1 10:00:00 2025
*mangle
:PREROUTING ACCEPT [0:0]
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:POSTROUTING ACCEPT [0:0]
-A PREROUTING -p icmp -j LOG --log-prefix "MANGLE-MARK-ICMP: "
-A PREROUTING -p icmp -j MARK --set-mark 0x1
-A PREROUTING -p tcp --dport 22 -j LOG --log-prefix "MANGLE-MARK-22: "
-A PREROUTING -p tcp --dport 22 -j MARK --set-mark 0x1
-A PREROUTING -p tcp --dport 161 -j LOG --log-prefix "MANGLE-MARK-161: "
-A PREROUTING -p tcp --dport 161 -j MARK --set-mark 0x1
-A PREROUTING -p tcp --dport 443 -j LOG --log-prefix "MANGLE-MARK-443: "
-A PREROUTING -p tcp --dport 443 -j MARK --set-mark 0x1
COMMIT
# Completed on Mon Jul  1 10:00:00 2025

EXIT_CODE: 0

=== TSIM_SECTION_END:iptables_save ===
=== TSIM_SECTION_START:ipset_save ===
TITLE: Ipset Save Output
COMMAND: /sbin/ipset save
TIMESTAMP: 2025-07-02 10:00:00
---
create test_hash_ip_port_ip hash:ip,port,ip
add test_hash_ip_port_ip 10.3.1.10,tcp:80,10.3.2.10
add test_hash_ip_port_ip 10.3.1.20,tcp:443,10.3.2.20
add test_hash_ip_port_ip 10.3.1.30,udp:53,10.3.2.30

EXIT_CODE: 0
=== TSIM_SECTION_END:ipset_save ===


<!DOCTYPE html>
<html>
<head>
    <title>Network Reachability Test</title>
    <link rel="stylesheet" href="/css/style.css">
    <script src="/js/form.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Network Reachability Test</h1>
            <a href="/cgi-bin/logout.py" class="logout">Logout</a>
        </header>
        
        <form id="reachability-form" action="/cgi-bin/main.py" method="POST">
            <div class="form-group">
                <label for="source_ip">Source IP Address *</label>
                <input type="text" id="source_ip" name="source_ip" 
                       pattern="^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$" 
                       required placeholder="e.g., 10.1.1.1">
            </div>
            
            <div class="form-group">
                <label for="source_port">Source Port (optional)</label>
                <input type="number" id="source_port" name="source_port" 
                       min="1" max="65535" placeholder="e.g., 12345">
            </div>
            
            <div class="form-group">
                <label for="dest_ip">Destination IP Address *</label>
                <input type="text" id="dest_ip" name="dest_ip" 
                       pattern="^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$" 
                       required placeholder="e.g., 10.2.1.1">
            </div>
            
            <div class="form-group">
                <label for="dest_port">Destination Port *</label>
                <input type="number" id="dest_port" name="dest_port" 
                       min="1" max="65535" required placeholder="e.g., 80">
            </div>
            
            <div class="form-group">
                <label for="protocol">Protocol *</label>
                <select id="protocol" name="protocol" required>
                    <option value="tcp">TCP</option>
                    <option value="udp">UDP</option>
                </select>
            </div>
            
            <!-- Hidden field for user trace data -->
            <input type="hidden" id="user_trace_data" name="user_trace_data" value="">
            
            <div class="form-actions">
                <button type="submit">Run Test</button>
                <button type="button" onclick="clearForm()">Clear</button>
                <button type="button" onclick="openTraceFileInput()">Trace File Input</button>
            </div>
        </form>
        
        <!-- Modal for trace file input -->
        <div id="traceModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Trace File Input</h2>
                    <span class="close" onclick="closeTraceModal()">&times;</span>
                </div>
                <div class="modal-body">
                    <p>Paste your trace file JSON content below:</p>
                    <textarea id="traceJsonInput" placeholder="Paste JSON trace data here..." rows="15"></textarea>
                    <div id="jsonValidationError" class="error-message" style="display: none;"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" onclick="validateAndSaveTrace()">Save</button>
                    <button type="button" onclick="clearTraceInput()">Clear</button>
                    <button type="button" onclick="closeTraceModal()">Cancel</button>
                </div>
            </div>
        </div>
        
        <div class="info">
            <p>This tool will generate a comprehensive network reachability report including:</p>
            <ul>
                <li>Network path trace</li>
                <li>Connectivity tests (ping, MTR, service)</li>
                <li>Firewall rule analysis</li>
                <li>Visual network diagram</li>
            </ul>
        </div>
    </div>
</body>
</html>
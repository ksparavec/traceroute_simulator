# Traceroute Simulator Facts Collection
# Generated on: 2025-06-21 14:48:35
# Hostname: dc-srv
# Kernel: 5.19.0-46-generic
# Collection Script Version: 1.0

# Locating required commands in standard paths
# Found commands:
# IP: /sbin/ip
# IPTABLES: /sbin/iptables
# IPTABLES-SAVE: /sbin/iptables-save
# IPSET: /sbin/ipset
# LSMOD: /bin/lsmod
# Running as root: 1

=== TSIM_SECTION_START:routing_table ===
TITLE: IP Routing Table
COMMAND: /sbin/ip route show
TIMESTAMP: 2025-06-21 14:48:35
---
default via 10.3.2.1 dev eth0 metric 1
10.3.2.0/24 dev eth0 proto kernel scope link src 10.3.2.3
10.3.10.0/24 dev eth1 proto kernel scope link src 10.3.10.1
10.3.20.0/24 dev eth2 proto kernel scope link src 10.3.20.1
10.3.21.0/24 dev eth3 proto kernel scope link src 10.3.21.1
10.3.1.0/24 via 10.3.2.1 dev eth0 metric 1
10.1.0.0/16 via 10.3.2.1 dev eth0 metric 10
10.2.0.0/16 via 10.3.2.1 dev eth0 metric 10
192.0.2.0/24 via 10.3.2.1 dev eth0 metric 1
198.51.100.0/24 via 10.3.2.1 dev eth0 metric 1
203.0.113.0/24 via 10.3.2.1 dev eth0 metric 1

EXIT_CODE: 0
=== TSIM_SECTION_END:routing_table ===

=== TSIM_SECTION_START:policy_rules ===
TITLE: IP Policy Rules
COMMAND: /sbin/ip rule show
TIMESTAMP: 2025-06-21 14:48:35
---
0:	from all lookup local
50:	from 10.3.10.0/24 lookup db_servers
100:	from 10.3.20.0/24 lookup web_servers
150:	from 10.3.21.0/24 lookup app_servers
32766:	from all lookup main
32767:	from all lookup default

EXIT_CODE: 0
=== TSIM_SECTION_END:policy_rules ===

=== TSIM_SECTION_START:interfaces ===
TITLE: Network Interfaces
COMMAND: /sbin/ip addr show
TIMESTAMP: 2025-06-21 14:48:35
---
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 52:54:00:42:34:01 brd ff:ff:ff:ff:ff:ff
    inet 10.3.2.3/24 brd 10.3.2.255 scope global eth0
       valid_lft forever preferred_lft forever
3: eth1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 52:54:00:42:34:02 brd ff:ff:ff:ff:ff:ff
    inet 10.3.10.1/24 brd 10.3.10.255 scope global eth1
       valid_lft forever preferred_lft forever
4: eth2: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 52:54:00:42:34:03 brd ff:ff:ff:ff:ff:ff
    inet 10.3.20.1/24 brd 10.3.20.255 scope global eth2
       valid_lft forever preferred_lft forever
5: eth3: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 52:54:00:42:34:04 brd ff:ff:ff:ff:ff:ff
    inet 10.3.21.1/24 brd 10.3.21.255 scope global eth3
       valid_lft forever preferred_lft forever

EXIT_CODE: 0
=== TSIM_SECTION_END:interfaces ===

=== TSIM_SECTION_START:interface_stats ===
TITLE: Interface Statistics
COMMAND: cat /proc/net/dev
TIMESTAMP: 2025-06-21 14:48:35
---
Inter-|   Receive                                                |  Transmit
 face |bytes    packets errs drop fifo frame compressed multicast|bytes    packets errs drop fifo colls carrier compressed
    lo:   56789      345    0    0    0     0          0         0    56789      345    0    0    0     0       0          0
  eth0: 6789012     7890    0    0    0     0          0         0  5678901     6789    0    0    0     0       0          0
  eth1: 8901234     9012    0    0    0     0          0         0  7890123     8901    0    0    0     0       0          0
  eth2: 1234567     2345    0    0    0     0          0         0  1123456     2234    0    0    0     0       0          0
  eth3: 3456789     4567    0    0    0     0          0         0  2345678     3456    0    0    0     0       0          0

EXIT_CODE: 0
=== TSIM_SECTION_END:interface_stats ===

=== TSIM_SECTION_START:ip_forwarding ===
TITLE: IP Forwarding Status
COMMAND: cat /proc/sys/net/ipv4/ip_forward
TIMESTAMP: 2025-06-21 14:48:35
---
1

EXIT_CODE: 0
=== TSIM_SECTION_END:ip_forwarding ===

=== TSIM_SECTION_START:kernel_version ===
TITLE: Kernel Version
COMMAND: uname -r
TIMESTAMP: 2025-06-21 14:48:35
---
5.19.0-46-generic

EXIT_CODE: 0
=== TSIM_SECTION_END:kernel_version ===

=== TSIM_SECTION_START:hostname ===
TITLE: System Hostname
COMMAND: hostname
TIMESTAMP: 2025-06-21 14:48:35
---
dc-srv

EXIT_CODE: 0
=== TSIM_SECTION_END:hostname ===

=== TSIM_SECTION_START:iptables_filter ===
TITLE: Iptables Filter Table
COMMAND: /sbin/iptables -t filter -L -n -v --line-numbers
TIMESTAMP: 2025-06-21 14:48:35
---
Chain INPUT (policy ACCEPT 0 packets, 0 bytes)
num   pkts bytes target     prot opt in     out     source               destination         
1      456  45678 ACCEPT     all  --  lo     *       0.0.0.0/0            0.0.0.0/0           
2     1789 178901 ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            ctstate RELATED,ESTABLISHED
3      678  67890 DC_MGMT_INPUT  all  --  *      *       0.0.0.0/0            10.3.2.3            
4      345  34567 DC_SERVICE_PROTECTION  all  --  eth1   *       0.0.0.0/0            10.3.10.0/24        
5      234  23456 DC_SERVICE_PROTECTION  all  --  eth2   *       0.0.0.0/0            10.3.20.0/24        
6      123  12345 DC_SERVICE_PROTECTION  all  --  eth3   *       0.0.0.0/0            10.3.21.0/24        
7       89   8901 ACCEPT     icmp --  *      *       10.3.0.0/16          0.0.0.0/0            icmp-type 8 limit: avg 20/sec burst 10
8       56   5678 ACCEPT     tcp  --  eth0   *       10.3.2.0/24          0.0.0.0/0            tcp dpt:22 ctstate NEW,ESTABLISHED
9       34   3456 LOG        all  --  *      *       0.0.0.0/0            0.0.0.0/0            limit: avg 15/min burst 20 LOG flags 0 level 4 prefix "DC-SRV-INPUT-DROP: "

Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
num   pkts bytes target     prot opt in     out     source               destination         
1     3456 345678 DC_SERVER_FORWARD  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
2     2345 234567 DB_ACCESS_CONTROL  all  --  *      eth1    0.0.0.0/0            10.3.10.0/24        
3     1234 123456 WEB_ACCESS_CONTROL  all  --  *      eth2    0.0.0.0/0            10.3.20.0/24        
4      789  78901 APP_ACCESS_CONTROL  all  --  *      eth3    0.0.0.0/0            10.3.21.0/24        
5      456  45678 ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            ctstate RELATED,ESTABLISHED
6      234  23456 LOG        all  --  *      *       0.0.0.0/0            0.0.0.0/0            limit: avg 8/min burst 12 LOG flags 0 level 6 prefix "DC-SRV-FORWARD: "

Chain OUTPUT (policy ACCEPT 0 packets, 0 bytes)
num   pkts bytes target     prot opt in     out     source               destination         
1      987  98765 ACCEPT     all  --  *      lo      0.0.0.0/0            0.0.0.0/0           
2      654  65432 ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            ctstate RELATED,ESTABLISHED
3      432  43210 ACCEPT     icmp --  *      *       0.0.0.0/0            10.3.0.0/16         
4      321  32109 ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp spt:22
5      210  21098 DC_OUTBOUND_AUDIT  all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain DC_MGMT_INPUT (1 references)
num   pkts bytes target     prot opt in     out     source               destination         
1      567  56789 ACCEPT     tcp  --  *      *       10.3.2.0/24          0.0.0.0/0            multiport dports 22,80,443,8080 ctstate NEW,ESTABLISHED
2      345  34567 ACCEPT     tcp  --  *      *       10.3.1.0/24          0.0.0.0/0            multiport dports 22,443 ctstate NEW,ESTABLISHED
3      234  23456 ACCEPT     udp  --  *      *       10.3.2.0/24          0.0.0.0/0            multiport dports 161,514,123 ctstate NEW,ESTABLISHED
4      123  12345 ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            match-set DC_ADMIN_SOURCES src match-set DC_MGMT_SERVICES dst,port
5       67   6789 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain DC_SERVICE_PROTECTION (3 references)
num   pkts bytes target     prot opt in     out     source               destination         
1      456  45678 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            match-set DC_ATTACK_IPS src
2      234  23456 RATE_LIMIT  tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            multiport dports 80,443,8080
3      123  12345 RATE_LIMIT  tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            multiport dports 3306,5432,1433,27017
4       67   6789 DROP       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            recent: CHECK seconds: 60 hit_count: 100 name: CONN_LIMIT side: source
5       34   3456 ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            match-set DC_TRUSTED_CLIENTS src
6       21   2109 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain DC_SERVER_FORWARD (1 references)
num   pkts bytes target     prot opt in     out     source               destination         
1     1234 123456 ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            match-set DC_INTER_SERVER_COMM src,dst,port
2      789  78901 DROP       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            match-set DC_BLOCKED_PROTOCOLS src,dst,port
3      456  45678 ACCEPT     tcp  --  eth0   *       10.3.2.0/24          10.3.0.0/16          multiport dports 22,80,443
4      234  23456 LOAD_BALANCE  tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            match-set DC_LB_SERVICES dst,port
5      123  12345 ACCEPT     icmp --  *      *       10.3.0.0/16          10.3.0.0/16         
6       67   6789 LOG        all  --  *      *       0.0.0.0/0            10.3.0.0/16          limit: avg 10/min burst 8 LOG flags 0 level 6 prefix "DC-SERVER-FWD: "
7       34   3456 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain DB_ACCESS_CONTROL (1 references)
num   pkts bytes target     prot opt in     out     source               destination         
1      789  78901 ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            match-set DC_DB_CLIENTS src match-set DC_DB_SERVERS dst,port
2      456  45678 ACCEPT     tcp  --  *      *       10.3.20.0/24         10.3.10.0/24         multiport dports 3306,5432
3      234  23456 ACCEPT     tcp  --  *      *       10.3.21.0/24         10.3.10.0/24         multiport dports 3306,5432,1433,27017
4      123  12345 DROP       tcp  --  *      *       0.0.0.0/0            10.3.10.0/24         multiport dports 22,3389
5       67   6789 ACCEPT     tcp  --  *      *       10.3.2.0/24          10.3.10.0/24         tcp dpt:22
6       34   3456 LOG        all  --  *      *       0.0.0.0/0            10.3.10.0/24         limit: avg 5/min burst 10 LOG flags 0 level 6 prefix "DB-ACCESS: "
7       21   2109 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain WEB_ACCESS_CONTROL (1 references)
num   pkts bytes target     prot opt in     out     source               destination         
1      567  56789 ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            match-set DC_WEB_ALLOWED src multiport dports 80,443,8080
2      345  34567 ACCEPT     tcp  --  *      *       10.3.21.0/24         10.3.20.0/24         multiport dports 80,443,8080,9000
3      234  23456 ACCEPT     tcp  --  *      *       10.3.2.0/24          10.3.20.0/24         multiport dports 22,80,443
4      123  12345 DROP       tcp  --  *      *       0.0.0.0/0            10.3.20.0/24         multiport dports 21,22,23,135,139,445
5       67   6789 ACCEPT     udp  --  *      *       10.3.20.0/24         10.3.2.0/24          udp dpt:53
6       34   3456 LOG        all  --  *      *       0.0.0.0/0            10.3.20.0/24         limit: avg 12/min burst 15 LOG flags 0 level 6 prefix "WEB-ACCESS: "
7       21   2109 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain APP_ACCESS_CONTROL (1 references)
num   pkts bytes target     prot opt in     out     source               destination         
1      456  45678 ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            match-set DC_APP_CLIENTS src match-set DC_APP_SERVERS dst,port
2      345  34567 ACCEPT     tcp  --  *      *       10.3.20.0/24         10.3.21.0/24         multiport dports 8080,9000,9443
3      234  23456 ACCEPT     tcp  --  *      *       10.3.2.0/24          10.3.21.0/24         multiport dports 22,8080,9000
4      123  12345 DROP       tcp  --  *      *       10.3.10.0/24         10.3.21.0/24         multiport dports 22,3389
5       67   6789 ACCEPT     udp  --  *      *       10.3.21.0/24         10.3.2.0/24          multiport dports 53,123
6       34   3456 LOG        all  --  *      *       0.0.0.0/0            10.3.21.0/24         limit: avg 8/min burst 12 LOG flags 0 level 6 prefix "APP-ACCESS: "
7       21   2109 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain DC_OUTBOUND_AUDIT (1 references)
num   pkts bytes target     prot opt in     out     source               destination         
1      345  34567 ACCEPT     tcp  --  *      *       10.3.0.0/16          0.0.0.0/0            match-set DC_UPDATE_DESTINATIONS dst,port
2      234  23456 ACCEPT     udp  --  *      *       10.3.0.0/16          0.0.0.0/0            udp dpt:53
3      123  12345 ACCEPT     tcp  --  *      *       10.3.2.3/32          0.0.0.0/0            multiport dports 22,80,443
4       67   6789 DROP       tcp  --  *      *       10.3.0.0/16          0.0.0.0/0            multiport dports 21,23,135,139,445,1433,3389
5       34   3456 LOG        all  --  *      *       10.3.0.0/16          0.0.0.0/0            limit: avg 6/min burst 8 LOG flags 0 level 6 prefix "DC-OUTBOUND: "
6       21   2109 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain RATE_LIMIT (2 references)
num   pkts bytes target     prot opt in     out     source               destination         
1      234  23456 ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            limit: avg 50/sec burst 100
2      123  12345 recent     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            recent: SET name: CONN_LIMIT side: source
3       67   6789 LOG        tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            limit: avg 5/min burst 10 LOG flags 0 level 4 prefix "RATE-LIMIT-EXCEED: "
4       34   3456 DROP       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain LOAD_BALANCE (1 references)
num   pkts bytes target     prot opt in     out     source               destination         
1       89   8901 DNAT       tcp  --  *      *       0.0.0.0/0            10.3.20.100/32       tcp dpt:80 statistic mode nth every 4 packet 0 to:10.3.20.10:80
2       56   5678 DNAT       tcp  --  *      *       0.0.0.0/0            10.3.20.100/32       tcp dpt:80 statistic mode nth every 3 packet 0 to:10.3.20.11:80
3       34   3456 DNAT       tcp  --  *      *       0.0.0.0/0            10.3.20.100/32       tcp dpt:80 statistic mode nth every 2 packet 0 to:10.3.20.12:80
4       21   2109 DNAT       tcp  --  *      *       0.0.0.0/0            10.3.20.100/32       tcp dpt:80 to:10.3.20.13:80
5       12   1234 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0           

EXIT_CODE: 0
=== TSIM_SECTION_END:iptables_filter ===

=== TSIM_SECTION_START:iptables_nat ===
TITLE: Iptables NAT Table
COMMAND: /sbin/iptables -t nat -L -n -v --line-numbers
TIMESTAMP: 2025-06-21 14:48:35
---
Chain PREROUTING (policy ACCEPT 0 packets, 0 bytes)
num   pkts bytes target     prot opt in     out     source               destination         
1      345  34567 DC_LOAD_BALANCER  tcp  --  eth0   *       0.0.0.0/0            10.3.2.3             multiport dports 80,443,8080
2      234  23456 DNAT       tcp  --  eth0   *       0.0.0.0/0            10.3.2.3             tcp dpt:3306 to:10.3.10.5:3306
3      123  12345 DNAT       tcp  --  eth0   *       0.0.0.0/0            10.3.2.3             tcp dpt:5432 to:10.3.10.6:5432
4       67   6789 DNAT       tcp  --  eth0   *       0.0.0.0/0            10.3.2.3             tcp dpt:9000 to:10.3.21.5:9000

Chain INPUT (policy ACCEPT 0 packets, 0 bytes)
num   pkts bytes target     prot opt in     out     source               destination         

Chain OUTPUT (policy ACCEPT 0 packets, 0 bytes)
num   pkts bytes target     prot opt in     out     source               destination         

Chain POSTROUTING (policy ACCEPT 0 packets, 0 bytes)
num   pkts bytes target     prot opt in     out     source               destination         
1     1234 123456 SNAT       all  --  *      eth0    10.3.10.0/24         0.0.0.0/0            to:10.3.2.3
2      789  78901 SNAT       all  --  *      eth0    10.3.20.0/24         0.0.0.0/0            to:10.3.2.3
3      456  45678 SNAT       all  --  *      eth0    10.3.21.0/24         0.0.0.0/0            to:10.3.2.3
4      234  23456 DC_SERVER_NAT  all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain DC_LOAD_BALANCER (1 references)
num   pkts bytes target     prot opt in     out     source               destination         
1       89   8901 DNAT       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:80 statistic mode random probability 0.25000000000 to:10.3.20.10:80
2       67   6789 DNAT       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:80 statistic mode random probability 0.33333333333 to:10.3.20.11:80
3       45   4567 DNAT       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:80 statistic mode random probability 0.50000000000 to:10.3.20.12:80
4       23   2345 DNAT       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:80 to:10.3.20.13:80
5       34   3456 DNAT       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:443 statistic mode random probability 0.50000000000 to:10.3.20.10:443
6       12   1234 DNAT       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:443 to:10.3.20.11:443
7       18   1876 DNAT       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:8080 to:10.3.21.10:8080
8        9    987 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain DC_SERVER_NAT (1 references)
num   pkts bytes target     prot opt in     out     source               destination         
1      123  12345 MASQUERADE  all  --  *      eth0    10.3.10.0/24         10.3.20.0/24        
2       89   8901 MASQUERADE  all  --  *      eth0    10.3.20.0/24         10.3.21.0/24        
3       67   6789 MASQUERADE  all  --  *      eth0    10.3.21.0/24         10.3.10.0/24        
4       45   4567 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0           

EXIT_CODE: 0
=== TSIM_SECTION_END:iptables_nat ===

=== TSIM_SECTION_START:iptables_mangle ===
TITLE: Iptables Mangle Table
COMMAND: /sbin/iptables -t mangle -L -n -v --line-numbers
TIMESTAMP: 2025-06-21 14:48:35
---
Chain PREROUTING (policy ACCEPT 0 packets, 0 bytes)
num   pkts bytes target     prot opt in     out     source               destination         
1     2345 234567 MARK       all  --  eth1   *       10.3.10.0/24         0.0.0.0/0            MARK set 0x10
2     1234 123456 MARK       all  --  eth2   *       10.3.20.0/24         0.0.0.0/0            MARK set 0x20
3      789  78901 MARK       all  --  eth3   *       10.3.21.0/24         0.0.0.0/0            MARK set 0x30
4      456  45678 DC_QOS_CLASSIFY  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
5      234  23456 DSCP       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            match-set DC_CRITICAL_DB dst,port DSCP set 0x2e

Chain INPUT (policy ACCEPT 0 packets, 0 bytes)
num   pkts bytes target     prot opt in     out     source               destination         

Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
num   pkts bytes target     prot opt in     out     source               destination         
1     3456 345678 DC_SERVER_QOS  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
2     2345 234567 CONNMARK   all  --  *      *       0.0.0.0/0            0.0.0.0/0            CONNMARK --restore-mark --nfmask 0xffffffff --ctmask 0xffffffff
3     1234 123456 MARK       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            match-set DC_HIGH_BW_APPS dst,port MARK set 0x100
4      789  78901 CONNMARK   all  --  *      *       0.0.0.0/0            0.0.0.0/0            CONNMARK --save-mark --nfmask 0xffffffff --ctmask 0xffffffff

Chain OUTPUT (policy ACCEPT 0 packets, 0 bytes)
num   pkts bytes target     prot opt in     out     source               destination         

Chain POSTROUTING (policy ACCEPT 0 packets, 0 bytes)
num   pkts bytes target     prot opt in     out     source               destination         
1     4567 456789 CLASSIFY   all  --  *      eth0    0.0.0.0/0            0.0.0.0/0            mark match 0x10 CLASSIFY set 1:10
2     3456 345678 CLASSIFY   all  --  *      eth0    0.0.0.0/0            0.0.0.0/0            mark match 0x20 CLASSIFY set 1:20
3     2345 234567 CLASSIFY   all  --  *      eth0    0.0.0.0/0            0.0.0.0/0            mark match 0x30 CLASSIFY set 1:30
4     1234 123456 DSCP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x100 DSCP set 0x2e

Chain DC_QOS_CLASSIFY (1 references)
num   pkts bytes target     prot opt in     out     source               destination         
1      678  67890 MARK       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            multiport dports 80,443,8080 MARK set 0x1
2      456  45678 MARK       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            multiport dports 3306,5432,1433 MARK set 0x2
3      345  34567 MARK       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            multiport dports 9000,9443 MARK set 0x3
4      234  23456 MARK       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            multiport dports 22,161 MARK set 0x4
5      123  12345 MARK       udp  --  *      *       0.0.0.0/0            0.0.0.0/0            multiport dports 53,123,514 MARK set 0x5
6       89   8901 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain DC_SERVER_QOS (1 references)
num   pkts bytes target     prot opt in     out     source               destination         
1      789  78901 DSCP       all  --  *      *       10.3.10.0/24         0.0.0.0/0            DSCP set 0x2e
2      567  56789 DSCP       all  --  *      *       10.3.20.0/24         0.0.0.0/0            DSCP set 0x00
3      456  45678 DSCP       all  --  *      *       10.3.21.0/24         0.0.0.0/0            DSCP set 0x08
4      345  34567 TOS        all  --  *      eth0    10.3.10.0/24         0.0.0.0/0            TOS set 0x10
5      234  23456 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            match-set DC_PRIORITY_FLOWS src,dst,port MARK set 0x1000
6      123  12345 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0           

EXIT_CODE: 0
=== TSIM_SECTION_END:iptables_mangle ===

=== TSIM_SECTION_START:iptables_save ===
TITLE: Complete Iptables Configuration
COMMAND: /sbin/iptables-save
TIMESTAMP: 2025-06-21 14:48:35
---
# Generated by iptables-save v1.8.7 on Fri Jun 21 14:48:35 2025
*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:DC_MGMT_INPUT - [0:0]
:DC_SERVICE_PROTECTION - [0:0]
:DC_SERVER_FORWARD - [0:0]
:DB_ACCESS_CONTROL - [0:0]
:WEB_ACCESS_CONTROL - [0:0]
:APP_ACCESS_CONTROL - [0:0]
:DC_OUTBOUND_AUDIT - [0:0]
:RATE_LIMIT - [0:0]
:LOAD_BALANCE - [0:0]
-A INPUT -i lo -j ACCEPT
-A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A INPUT -d 10.3.2.3/32 -j DC_MGMT_INPUT
-A INPUT -i eth1 -d 10.3.10.0/24 -j DC_SERVICE_PROTECTION
-A INPUT -i eth2 -d 10.3.20.0/24 -j DC_SERVICE_PROTECTION
-A INPUT -i eth3 -d 10.3.21.0/24 -j DC_SERVICE_PROTECTION
-A INPUT -s 10.3.0.0/16 -p icmp -m icmp --icmp-type 8 -m limit --limit 20/sec --limit-burst 10 -j ACCEPT
-A INPUT -s 10.3.2.0/24 -i eth0 -p tcp -m tcp --dport 22 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -m limit --limit 15/min --limit-burst 20 -j LOG --log-prefix "DC-SRV-INPUT-DROP: "
-A FORWARD -j DC_SERVER_FORWARD
-A FORWARD -o eth1 -d 10.3.10.0/24 -j DB_ACCESS_CONTROL
-A FORWARD -o eth2 -d 10.3.20.0/24 -j WEB_ACCESS_CONTROL
-A FORWARD -o eth3 -d 10.3.21.0/24 -j APP_ACCESS_CONTROL
-A FORWARD -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A FORWARD -m limit --limit 8/min --limit-burst 12 -j LOG --log-prefix "DC-SRV-FORWARD: " --log-level 6
-A OUTPUT -o lo -j ACCEPT
-A OUTPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A OUTPUT -d 10.3.0.0/16 -p icmp -j ACCEPT
-A OUTPUT -p tcp -m tcp --sport 22 -j ACCEPT
-A OUTPUT -j DC_OUTBOUND_AUDIT
-A DC_MGMT_INPUT -s 10.3.2.0/24 -p tcp -m multiport --dports 22,80,443,8080 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A DC_MGMT_INPUT -s 10.3.1.0/24 -p tcp -m multiport --dports 22,443 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A DC_MGMT_INPUT -s 10.3.2.0/24 -p udp -m multiport --dports 161,514,123 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A DC_MGMT_INPUT -m set --match-set DC_ADMIN_SOURCES src --match-set DC_MGMT_SERVICES dst,port -p tcp -j ACCEPT
-A DC_MGMT_INPUT -j RETURN
-A DC_SERVICE_PROTECTION -m set --match-set DC_ATTACK_IPS src -j DROP
-A DC_SERVICE_PROTECTION -p tcp -m multiport --dports 80,443,8080 -j RATE_LIMIT
-A DC_SERVICE_PROTECTION -p tcp -m multiport --dports 3306,5432,1433,27017 -j RATE_LIMIT
-A DC_SERVICE_PROTECTION -p tcp -m recent --check --seconds 60 --hitcount 100 --name CONN_LIMIT --rsource -j DROP
-A DC_SERVICE_PROTECTION -m set --match-set DC_TRUSTED_CLIENTS src -j ACCEPT
-A DC_SERVICE_PROTECTION -j RETURN
-A DC_SERVER_FORWARD -m set --match-set DC_INTER_SERVER_COMM src,dst,port -j ACCEPT
-A DC_SERVER_FORWARD -m set --match-set DC_BLOCKED_PROTOCOLS src,dst,port -p tcp -j DROP
-A DC_SERVER_FORWARD -s 10.3.2.0/24 -d 10.3.0.0/16 -i eth0 -p tcp -m multiport --dports 22,80,443 -j ACCEPT
-A DC_SERVER_FORWARD -m set --match-set DC_LB_SERVICES dst,port -p tcp -j LOAD_BALANCE
-A DC_SERVER_FORWARD -s 10.3.0.0/16 -d 10.3.0.0/16 -p icmp -j ACCEPT
-A DC_SERVER_FORWARD -d 10.3.0.0/16 -m limit --limit 10/min --limit-burst 8 -j LOG --log-prefix "DC-SERVER-FWD: " --log-level 6
-A DC_SERVER_FORWARD -j RETURN
-A DB_ACCESS_CONTROL -m set --match-set DC_DB_CLIENTS src --match-set DC_DB_SERVERS dst,port -p tcp -j ACCEPT
-A DB_ACCESS_CONTROL -s 10.3.20.0/24 -d 10.3.10.0/24 -p tcp -m multiport --dports 3306,5432 -j ACCEPT
-A DB_ACCESS_CONTROL -s 10.3.21.0/24 -d 10.3.10.0/24 -p tcp -m multiport --dports 3306,5432,1433,27017 -j ACCEPT
-A DB_ACCESS_CONTROL -d 10.3.10.0/24 -p tcp -m multiport --dports 22,3389 -j DROP
-A DB_ACCESS_CONTROL -s 10.3.2.0/24 -d 10.3.10.0/24 -p tcp -m tcp --dport 22 -j ACCEPT
-A DB_ACCESS_CONTROL -d 10.3.10.0/24 -m limit --limit 5/min --limit-burst 10 -j LOG --log-prefix "DB-ACCESS: " --log-level 6
-A DB_ACCESS_CONTROL -j RETURN
-A WEB_ACCESS_CONTROL -m set --match-set DC_WEB_ALLOWED src -p tcp -m multiport --dports 80,443,8080 -j ACCEPT
-A WEB_ACCESS_CONTROL -s 10.3.21.0/24 -d 10.3.20.0/24 -p tcp -m multiport --dports 80,443,8080,9000 -j ACCEPT
-A WEB_ACCESS_CONTROL -s 10.3.2.0/24 -d 10.3.20.0/24 -p tcp -m multiport --dports 22,80,443 -j ACCEPT
-A WEB_ACCESS_CONTROL -d 10.3.20.0/24 -p tcp -m multiport --dports 21,22,23,135,139,445 -j DROP
-A WEB_ACCESS_CONTROL -s 10.3.20.0/24 -d 10.3.2.0/24 -p udp -m udp --dport 53 -j ACCEPT
-A WEB_ACCESS_CONTROL -d 10.3.20.0/24 -m limit --limit 12/min --limit-burst 15 -j LOG --log-prefix "WEB-ACCESS: " --log-level 6
-A WEB_ACCESS_CONTROL -j RETURN
-A APP_ACCESS_CONTROL -m set --match-set DC_APP_CLIENTS src --match-set DC_APP_SERVERS dst,port -p tcp -j ACCEPT
-A APP_ACCESS_CONTROL -s 10.3.20.0/24 -d 10.3.21.0/24 -p tcp -m multiport --dports 8080,9000,9443 -j ACCEPT
-A APP_ACCESS_CONTROL -s 10.3.2.0/24 -d 10.3.21.0/24 -p tcp -m multiport --dports 22,8080,9000 -j ACCEPT
-A APP_ACCESS_CONTROL -s 10.3.10.0/24 -d 10.3.21.0/24 -p tcp -m multiport --dports 22,3389 -j DROP
-A APP_ACCESS_CONTROL -s 10.3.21.0/24 -d 10.3.2.0/24 -p udp -m multiport --dports 53,123 -j ACCEPT
-A APP_ACCESS_CONTROL -d 10.3.21.0/24 -m limit --limit 8/min --limit-burst 12 -j LOG --log-prefix "APP-ACCESS: " --log-level 6
-A APP_ACCESS_CONTROL -j RETURN
-A DC_OUTBOUND_AUDIT -s 10.3.0.0/16 -m set --match-set DC_UPDATE_DESTINATIONS dst,port -p tcp -j ACCEPT
-A DC_OUTBOUND_AUDIT -s 10.3.0.0/16 -p udp -m udp --dport 53 -j ACCEPT
-A DC_OUTBOUND_AUDIT -s 10.3.2.3/32 -p tcp -m multiport --dports 22,80,443 -j ACCEPT
-A DC_OUTBOUND_AUDIT -s 10.3.0.0/16 -p tcp -m multiport --dports 21,23,135,139,445,1433,3389 -j DROP
-A DC_OUTBOUND_AUDIT -s 10.3.0.0/16 -m limit --limit 6/min --limit-burst 8 -j LOG --log-prefix "DC-OUTBOUND: " --log-level 6
-A DC_OUTBOUND_AUDIT -j RETURN
-A RATE_LIMIT -p tcp -m limit --limit 50/sec --limit-burst 100 -j ACCEPT
-A RATE_LIMIT -p tcp -m recent --set --name CONN_LIMIT --rsource
-A RATE_LIMIT -p tcp -m limit --limit 5/min --limit-burst 10 -j LOG --log-prefix "RATE-LIMIT-EXCEED: "
-A RATE_LIMIT -p tcp -j DROP
-A LOAD_BALANCE -d 10.3.20.100/32 -p tcp -m tcp --dport 80 -m statistic --mode nth --every 4 --packet 0 -j DNAT --to-destination 10.3.20.10:80
-A LOAD_BALANCE -d 10.3.20.100/32 -p tcp -m tcp --dport 80 -m statistic --mode nth --every 3 --packet 0 -j DNAT --to-destination 10.3.20.11:80
-A LOAD_BALANCE -d 10.3.20.100/32 -p tcp -m tcp --dport 80 -m statistic --mode nth --every 2 --packet 0 -j DNAT --to-destination 10.3.20.12:80
-A LOAD_BALANCE -d 10.3.20.100/32 -p tcp -m tcp --dport 80 -j DNAT --to-destination 10.3.20.13:80
-A LOAD_BALANCE -j RETURN
COMMIT
# Completed on Fri Jun 21 14:48:35 2025
# Generated by iptables-save v1.8.7 on Fri Jun 21 14:48:35 2025
*nat
:PREROUTING ACCEPT [0:0]
:INPUT ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:POSTROUTING ACCEPT [0:0]
:DC_LOAD_BALANCER - [0:0]
:DC_SERVER_NAT - [0:0]
-A PREROUTING -i eth0 -d 10.3.2.3/32 -p tcp -m multiport --dports 80,443,8080 -j DC_LOAD_BALANCER
-A PREROUTING -i eth0 -d 10.3.2.3/32 -p tcp -m tcp --dport 3306 -j DNAT --to-destination 10.3.10.5:3306
-A PREROUTING -i eth0 -d 10.3.2.3/32 -p tcp -m tcp --dport 5432 -j DNAT --to-destination 10.3.10.6:5432
-A PREROUTING -i eth0 -d 10.3.2.3/32 -p tcp -m tcp --dport 9000 -j DNAT --to-destination 10.3.21.5:9000
-A POSTROUTING -s 10.3.10.0/24 -o eth0 -j SNAT --to-source 10.3.2.3
-A POSTROUTING -s 10.3.20.0/24 -o eth0 -j SNAT --to-source 10.3.2.3
-A POSTROUTING -s 10.3.21.0/24 -o eth0 -j SNAT --to-source 10.3.2.3
-A POSTROUTING -j DC_SERVER_NAT
-A DC_LOAD_BALANCER -p tcp -m tcp --dport 80 -m statistic --mode random --probability 0.25000000000 -j DNAT --to-destination 10.3.20.10:80
-A DC_LOAD_BALANCER -p tcp -m tcp --dport 80 -m statistic --mode random --probability 0.33333333333 -j DNAT --to-destination 10.3.20.11:80
-A DC_LOAD_BALANCER -p tcp -m tcp --dport 80 -m statistic --mode random --probability 0.50000000000 -j DNAT --to-destination 10.3.20.12:80
-A DC_LOAD_BALANCER -p tcp -m tcp --dport 80 -j DNAT --to-destination 10.3.20.13:80
-A DC_LOAD_BALANCER -p tcp -m tcp --dport 443 -m statistic --mode random --probability 0.50000000000 -j DNAT --to-destination 10.3.20.10:443
-A DC_LOAD_BALANCER -p tcp -m tcp --dport 443 -j DNAT --to-destination 10.3.20.11:443
-A DC_LOAD_BALANCER -p tcp -m tcp --dport 8080 -j DNAT --to-destination 10.3.21.10:8080
-A DC_LOAD_BALANCER -j RETURN
-A DC_SERVER_NAT -s 10.3.10.0/24 -d 10.3.20.0/24 -o eth0 -j MASQUERADE
-A DC_SERVER_NAT -s 10.3.20.0/24 -d 10.3.21.0/24 -o eth0 -j MASQUERADE
-A DC_SERVER_NAT -s 10.3.21.0/24 -d 10.3.10.0/24 -o eth0 -j MASQUERADE
-A DC_SERVER_NAT -j RETURN
COMMIT
# Completed on Fri Jun 21 14:48:35 2025
# Generated by iptables-save v1.8.7 on Fri Jun 21 14:48:35 2025
*mangle
:PREROUTING ACCEPT [0:0]
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:POSTROUTING ACCEPT [0:0]
:DC_QOS_CLASSIFY - [0:0]
:DC_SERVER_QOS - [0:0]
-A PREROUTING -s 10.3.10.0/24 -i eth1 -j MARK --set-xmark 0x10/0xffffffff
-A PREROUTING -s 10.3.20.0/24 -i eth2 -j MARK --set-xmark 0x20/0xffffffff
-A PREROUTING -s 10.3.21.0/24 -i eth3 -j MARK --set-xmark 0x30/0xffffffff
-A PREROUTING -j DC_QOS_CLASSIFY
-A PREROUTING -m set --match-set DC_CRITICAL_DB dst,port -p tcp -j DSCP --set-dscp 0x2e
-A FORWARD -j DC_SERVER_QOS
-A FORWARD -j CONNMARK --restore-mark --nfmask 0xffffffff --ctmask 0xffffffff
-A FORWARD -m set --match-set DC_HIGH_BW_APPS dst,port -p tcp -j MARK --set-xmark 0x100/0xffffffff
-A FORWARD -j CONNMARK --save-mark --nfmask 0xffffffff --ctmask 0xffffffff
-A POSTROUTING -m mark --mark 0x10 -o eth0 -j CLASSIFY --set-class 1:10
-A POSTROUTING -m mark --mark 0x20 -o eth0 -j CLASSIFY --set-class 1:20
-A POSTROUTING -m mark --mark 0x30 -o eth0 -j CLASSIFY --set-class 1:30
-A POSTROUTING -m mark --mark 0x100 -j DSCP --set-dscp 0x2e
-A DC_QOS_CLASSIFY -p tcp -m multiport --dports 80,443,8080 -j MARK --set-xmark 0x1/0xffffffff
-A DC_QOS_CLASSIFY -p tcp -m multiport --dports 3306,5432,1433 -j MARK --set-xmark 0x2/0xffffffff
-A DC_QOS_CLASSIFY -p tcp -m multiport --dports 9000,9443 -j MARK --set-xmark 0x3/0xffffffff
-A DC_QOS_CLASSIFY -p tcp -m multiport --dports 22,161 -j MARK --set-xmark 0x4/0xffffffff
-A DC_QOS_CLASSIFY -p udp -m multiport --dports 53,123,514 -j MARK --set-xmark 0x5/0xffffffff
-A DC_QOS_CLASSIFY -j RETURN
-A DC_SERVER_QOS -s 10.3.10.0/24 -j DSCP --set-dscp 0x2e
-A DC_SERVER_QOS -s 10.3.20.0/24 -j DSCP --set-dscp 0x00
-A DC_SERVER_QOS -s 10.3.21.0/24 -j DSCP --set-dscp 0x08
-A DC_SERVER_QOS -s 10.3.10.0/24 -o eth0 -j TOS --set-tos 0x10
-A DC_SERVER_QOS -m set --match-set DC_PRIORITY_FLOWS src,dst,port -j MARK --set-xmark 0x1000/0xffffffff
-A DC_SERVER_QOS -j RETURN
COMMIT
# Completed on Fri Jun 21 14:48:35 2025

EXIT_CODE: 0
=== TSIM_SECTION_END:iptables_save ===

=== TSIM_SECTION_START:ipset_list ===
TITLE: Ipset Lists and Membership
COMMAND: /sbin/ipset list
TIMESTAMP: 2025-06-21 14:48:35
---
Name: DC_ADMIN_SOURCES
Type: hash:net
Revision: 6
Header: family inet hashsize 1024 maxelem 65536
Size in memory: 456
References: 1
Number of entries: 4
Members:
10.3.1.0/24
10.3.2.0/24
10.100.1.0/24
192.0.2.0/24

Name: DC_MGMT_SERVICES
Type: hash:ip,port
Revision: 5
Header: family inet hashsize 1024 maxelem 65536
Size in memory: 584
References: 1
Number of entries: 8
Members:
10.3.2.3,tcp:22
10.3.2.3,tcp:80
10.3.2.3,tcp:443
10.3.2.3,tcp:8080
10.3.2.3,udp:161
10.3.10.1,tcp:22
10.3.20.1,tcp:22
10.3.21.1,tcp:22

Name: DC_ATTACK_IPS
Type: hash:net
Revision: 6
Header: family inet hashsize 1024 maxelem 65536
Size in memory: 712
References: 1
Number of entries: 18
Members:
1.2.3.0/24
5.6.7.0/24
8.9.10.0/24
45.66.230.0/24
45.66.231.0/24
91.240.118.0/24
103.109.247.0/24
141.98.80.0/24
141.98.81.0/24
185.220.100.0/24
185.220.101.0/24
198.96.155.0/24
23.129.64.0/24
104.244.42.0/24
178.162.202.0/24
192.42.116.0/24
199.87.154.0/24
77.247.181.0/24

Name: DC_TRUSTED_CLIENTS
Type: hash:net
Revision: 6
Header: family inet hashsize 1024 maxelem 65536
Size in memory: 520
References: 1
Number of entries: 5
Members:
10.3.1.0/24
10.3.2.0/24
10.100.1.0/24
192.0.2.0/24
203.0.113.0/24

Name: DC_INTER_SERVER_COMM
Type: hash:net,net,port
Revision: 0
Header: family inet hashsize 1024 maxelem 65536
Size in memory: 1240
References: 1
Number of entries: 20
Members:
10.3.10.0/24,10.3.20.0/24,tcp:3306
10.3.10.0/24,10.3.20.0/24,tcp:5432
10.3.10.0/24,10.3.21.0/24,tcp:3306
10.3.10.0/24,10.3.21.0/24,tcp:5432
10.3.10.0/24,10.3.21.0/24,tcp:1433
10.3.10.0/24,10.3.21.0/24,tcp:27017
10.3.20.0/24,10.3.10.0/24,tcp:3306
10.3.20.0/24,10.3.10.0/24,tcp:5432
10.3.20.0/24,10.3.21.0/24,tcp:8080
10.3.20.0/24,10.3.21.0/24,tcp:9000
10.3.20.0/24,10.3.21.0/24,tcp:9443
10.3.21.0/24,10.3.10.0/24,tcp:3306
10.3.21.0/24,10.3.10.0/24,tcp:5432
10.3.21.0/24,10.3.10.0/24,tcp:1433
10.3.21.0/24,10.3.10.0/24,tcp:27017
10.3.21.0/24,10.3.20.0/24,tcp:80
10.3.21.0/24,10.3.20.0/24,tcp:443
10.3.21.0/24,10.3.20.0/24,tcp:8080
10.3.2.0/24,10.3.10.0/24,tcp:22
10.3.2.0/24,10.3.20.0/24,tcp:22

Name: DC_BLOCKED_PROTOCOLS
Type: hash:net,net,port
Revision: 0
Header: family inet hashsize 1024 maxelem 65536
Size in memory: 984
References: 1
Number of entries: 12
Members:
0.0.0.0/0,10.3.10.0/24,tcp:22
0.0.0.0/0,10.3.10.0/24,tcp:3389
0.0.0.0/0,10.3.20.0/24,tcp:21
0.0.0.0/0,10.3.20.0/24,tcp:22
0.0.0.0/0,10.3.20.0/24,tcp:23
0.0.0.0/0,10.3.20.0/24,tcp:135
0.0.0.0/0,10.3.20.0/24,tcp:139
0.0.0.0/0,10.3.20.0/24,tcp:445
0.0.0.0/0,10.3.21.0/24,tcp:22
0.0.0.0/0,10.3.21.0/24,tcp:3389
10.3.10.0/24,10.3.21.0/24,tcp:22
10.3.10.0/24,10.3.21.0/24,tcp:3389

Name: DC_LB_SERVICES
Type: hash:ip,port
Revision: 5
Header: family inet hashsize 1024 maxelem 65536
Size in memory: 520
References: 1
Number of entries: 6
Members:
10.3.20.100,tcp:80
10.3.20.100,tcp:443
10.3.20.100,tcp:8080
10.3.21.100,tcp:8080
10.3.21.100,tcp:9000
10.3.21.100,tcp:9443

Name: DC_DB_CLIENTS
Type: hash:net
Revision: 6
Header: family inet hashsize 1024 maxelem 65536
Size in memory: 456
References: 1
Number of entries: 4
Members:
10.3.2.0/24
10.3.20.0/24
10.3.21.0/24
10.100.1.0/24

Name: DC_DB_SERVERS
Type: hash:ip,port
Revision: 5
Header: family inet hashsize 1024 maxelem 65536
Size in memory: 648
References: 1
Number of entries: 12
Members:
10.3.10.5,tcp:3306
10.3.10.6,tcp:5432
10.3.10.7,tcp:1433
10.3.10.8,tcp:1521
10.3.10.9,tcp:27017
10.3.10.10,tcp:6379
10.3.10.11,tcp:5984
10.3.10.12,tcp:9042
10.3.10.13,tcp:7000
10.3.10.14,tcp:8086
10.3.10.15,tcp:9200
10.3.10.16,tcp:5601

Name: DC_WEB_ALLOWED
Type: hash:net
Revision: 6
Header: family inet hashsize 1024 maxelem 65536
Size in memory: 520
References: 1
Number of entries: 5
Members:
10.3.1.0/24
10.3.2.0/24
10.3.21.0/24
10.100.1.0/24
192.0.2.0/24

Name: DC_APP_CLIENTS
Type: hash:net
Revision: 6
Header: family inet hashsize 1024 maxelem 65536
Size in memory: 456
References: 1
Number of entries: 4
Members:
10.3.2.0/24
10.3.20.0/24
10.100.1.0/24
192.0.2.0/24

Name: DC_APP_SERVERS
Type: hash:ip,port
Revision: 5
Header: family inet hashsize 1024 maxelem 65536
Size in memory: 712
References: 1
Number of entries: 15
Members:
10.3.21.5,tcp:8080
10.3.21.5,tcp:9000
10.3.21.5,tcp:9443
10.3.21.6,tcp:8080
10.3.21.6,tcp:9000
10.3.21.7,tcp:8080
10.3.21.7,tcp:9443
10.3.21.8,tcp:8080
10.3.21.8,tcp:9000
10.3.21.9,tcp:9000
10.3.21.9,tcp:9443
10.3.21.10,tcp:8080
10.3.21.11,tcp:9000
10.3.21.12,tcp:9443
10.3.21.13,tcp:8080

Name: DC_UPDATE_DESTINATIONS
Type: hash:net,port
Revision: 0
Header: family inet hashsize 1024 maxelem 65536
Size in memory: 776
References: 1
Number of entries: 12
Members:
archive.ubuntu.com,tcp:80
archive.ubuntu.com,tcp:443
security.ubuntu.com,tcp:80
security.ubuntu.com,tcp:443
8.8.8.8/32,tcp:53
8.8.4.4/32,tcp:53
1.1.1.1/32,tcp:53
208.67.222.222/32,tcp:53
91.189.95.83/32,tcp:80
91.189.95.85/32,tcp:443
docker.io,tcp:443
registry-1.docker.io,tcp:443

Name: DC_CRITICAL_DB
Type: hash:ip,port
Revision: 5
Header: family inet hashsize 1024 maxelem 65536
Size in memory: 520
References: 1
Number of entries: 6
Members:
10.3.10.5,tcp:3306
10.3.10.6,tcp:5432
10.3.10.7,tcp:1433
10.3.10.8,tcp:1521
10.3.10.9,tcp:27017
10.3.10.15,tcp:9200

Name: DC_HIGH_BW_APPS
Type: hash:ip,port
Revision: 5
Header: family inet hashsize 1024 maxelem 65536
Size in memory: 584
References: 1
Number of entries: 8
Members:
10.3.21.5,tcp:8080
10.3.21.6,tcp:9000
10.3.21.7,tcp:9443
10.3.21.8,tcp:8080
10.3.20.10,tcp:80
10.3.20.11,tcp:443
10.3.20.12,tcp:8080
10.3.20.13,tcp:80

Name: DC_PRIORITY_FLOWS
Type: hash:net,net,port
Revision: 0
Header: family inet hashsize 1024 maxelem 65536
Size in memory: 1048
References: 1
Number of entries: 15
Members:
10.3.10.0/24,10.3.20.0/24,tcp:3306
10.3.10.0/24,10.3.20.0/24,tcp:5432
10.3.10.0/24,10.3.21.0/24,tcp:3306
10.3.10.0/24,10.3.21.0/24,tcp:5432
10.3.10.0/24,10.3.21.0/24,tcp:1433
10.3.20.0/24,10.3.21.0/24,tcp:8080
10.3.20.0/24,10.3.21.0/24,tcp:9000
10.3.21.0/24,10.3.10.0/24,tcp:3306
10.3.21.0/24,10.3.10.0/24,tcp:5432
10.3.21.0/24,10.3.20.0/24,tcp:80
10.3.21.0/24,10.3.20.0/24,tcp:443
10.3.2.0/24,10.3.10.0/24,tcp:22
10.3.2.0/24,10.3.20.0/24,tcp:22
10.3.2.0/24,10.3.21.0/24,tcp:22
10.3.1.0/24,10.3.2.0/24,tcp:22

Name: DC_SERVER_CLASSES
Type: hash:ip,mark
Revision: 2
Header: family inet hashsize 1024 maxelem 65536
Size in memory: 648
References: 0
Number of entries: 12
Members:
10.3.10.5,0x100
10.3.10.6,0x100
10.3.10.7,0x200
10.3.10.8,0x200
10.3.20.10,0x300
10.3.20.11,0x300
10.3.20.12,0x400
10.3.20.13,0x400
10.3.21.5,0x500
10.3.21.6,0x500
10.3.21.7,0x600
10.3.21.8,0x600

Name: DC_BACKUP_SCHEDULE
Type: hash:net,iface
Revision: 1
Header: family inet hashsize 1024 maxelem 65536
Size in memory: 520
References: 0
Number of entries: 4
Members:
10.3.10.0/24,eth1
10.3.20.0/24,eth2
10.3.21.0/24,eth3
10.3.2.0/24,eth0

Name: DC_MONITORING_TARGETS
Type: hash:ip,port,net
Revision: 1
Header: family inet hashsize 1024 maxelem 65536
Size in memory: 984
References: 0
Number of entries: 12
Members:
10.3.10.5,3306,10.3.2.0/24
10.3.10.6,5432,10.3.2.0/24
10.3.10.7,1433,10.3.2.0/24
10.3.20.10,80,10.3.2.0/24
10.3.20.11,443,10.3.2.0/24
10.3.20.12,8080,10.3.2.0/24
10.3.21.5,8080,10.3.2.0/24
10.3.21.6,9000,10.3.2.0/24
10.3.21.7,9443,10.3.2.0/24
10.3.2.3,22,10.3.1.0/24
10.3.2.3,161,10.3.1.0/24
10.3.2.3,443,10.3.1.0/24

EXIT_CODE: 0
=== TSIM_SECTION_END:ipset_list ===

=== TSIM_SECTION_START:conntrack ===
TITLE: Connection Tracking Entries (first 10)
COMMAND: head -10 /proc/net/nf_conntrack
TIMESTAMP: 2025-06-21 14:48:35
---
ipv4     2 tcp      6 431997 ESTABLISHED src=10.3.20.10 dst=10.3.10.5 sport=54321 dport=3306 src=10.3.10.5 dst=10.3.20.10 sport=3306 dport=54321 [ASSURED] mark=2 use=1
ipv4     2 tcp      6 431996 ESTABLISHED src=10.3.21.5 dst=10.3.10.6 sport=65432 dport=5432 src=10.3.10.6 dst=10.3.21.5 sport=5432 dport=65432 [ASSURED] mark=2 use=1
ipv4     2 tcp      6 431995 ESTABLISHED src=10.3.2.100 dst=10.3.20.11 sport=76543 dport=80 src=10.3.20.11 dst=10.3.2.100 sport=80 dport=76543 [ASSURED] mark=1 use=1
ipv4     2 tcp      6 431994 ESTABLISHED src=10.3.21.6 dst=10.3.20.12 sport=87654 dport=8080 src=10.3.20.12 dst=10.3.21.6 sport=8080 dport=87654 [ASSURED] mark=1 use=1
ipv4     2 udp     17 29 src=10.3.20.15 dst=8.8.8.8 sport=98765 dport=53 src=8.8.8.8 dst=10.3.2.3 sport=53 dport=98765 mark=5 use=1
ipv4     2 tcp      6 431993 ESTABLISHED src=10.3.1.50 dst=10.3.21.7 sport=10987 dport=9443 src=10.3.21.7 dst=10.3.1.50 sport=9443 dport=10987 [ASSURED] mark=3 use=1
ipv4     2 icmp     1 29 src=10.3.10.8 dst=10.3.21.9 type=8 code=0 id=21098 src=10.3.21.9 dst=10.3.10.8 type=0 code=0 id=21098 use=1
ipv4     2 tcp      6 431992 ESTABLISHED src=10.3.2.25 dst=10.3.10.15 sport=32109 dport=9200 src=10.3.10.15 dst=10.3.2.25 sport=9200 dport=32109 [ASSURED] mark=2 use=1
ipv4     2 tcp      6 86395 TIME_WAIT src=10.3.21.10 dst=10.3.20.13 sport=43210 dport=80 src=10.3.20.13 dst=10.3.21.10 sport=80 dport=43210 [ASSURED] mark=1 use=1
ipv4     2 udp     17 28 src=10.3.21.8 dst=10.3.2.200 sport=54321 dport=123 src=10.3.2.200 dst=10.3.21.8 sport=123 dport=54321 mark=5 use=1

EXIT_CODE: 0
=== TSIM_SECTION_END:conntrack ===

=== TSIM_SECTION_START:netfilter_modules ===
TITLE: Loaded Netfilter Modules
COMMAND: /bin/lsmod | /bin/grep -E '(iptable|netfilter|conntrack|nf_)'
TIMESTAMP: 2025-06-21 14:48:35
---
nf_conntrack_netlink    49152  0
nf_conntrack           139264  1 nf_conntrack_netlink
nf_defrag_ipv4         16384  1 nf_conntrack
libcrc32c              16384  1 nf_conntrack
iptable_mangle         16384  1
iptable_nat            16384  1
iptable_filter         16384  1
ip_tables              32768  3 iptable_filter,iptable_mangle,iptable_nat
nf_nat                 45056  1 iptable_nat
nf_log_syslog          20480  1
nf_log_common          16384  1 nf_log_syslog
xt_multiport           20480  42
xt_conntrack           20480  28
xt_mark                16384  15
xt_MARK                16384  15
xt_set                 16384  25
xt_DSCP                16384  8
xt_TOS                 16384  4
xt_LOG                 16384  8
xt_limit               16384  18
xt_tcpudp              20480  45
xt_SNAT                20480  6
xt_DNAT                20480  10
xt_MASQUERADE          20480  3
xt_recent              20480  3
xt_statistic           16384  8
xt_CONNMARK            16384  4
xt_CLASSIFY            16384  4

EXIT_CODE: 0
=== TSIM_SECTION_END:netfilter_modules ===

=== TSIM_FACTS_COLLECTION_COMPLETE ===
TIMESTAMP: 2025-06-21 14:48:35
HOSTNAME: dc-srv
SECTIONS_COLLECTED: routing_table,policy_rules,interfaces,interface_stats,ip_forwarding,kernel_version,hostname,iptables_*,ipset_*,conntrack,netfilter_modules
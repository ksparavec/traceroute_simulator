{
    "data_retention_days": 365,
    "session_timeout": 3600,
    "venv_path": "/opt/tsim/venv",
    "tsimsh_path": "tsimsh",
    "traceroute_simulator_path": "/opt/tsim/wsgi/scripts",
    "traceroute_simulator_conf": "/opt/tsim/wsgi/conf/traceroute_simulator.yaml",
    "traceroute_simulator_facts": "/opt/tsim/facts",
    "traceroute_simulator_raw_facts": "/opt/tsim/raw_facts",
    "traceroute_simulator_mode": "test",
    "log_level": "DEBUG",
    "secret_key": "CHANGE-THIS-SECRET-KEY-IN-PRODUCTION",
    "controller_ip": "127.0.0.1",
    "registry_files": {
        "hosts": "/dev/shm/tsim/host_registry.json",
        "host_leases": "/dev/shm/tsim/host_leases.json",
        "neighbor_leases": "/dev/shm/tsim/neighbor_leases.json",
        "routers": "/dev/shm/tsim/router_registry.json",
        "interfaces": "/dev/shm/tsim/interface_registry.json",
        "bridges": "/dev/shm/tsim/bridge_registry.json",
        "services": "/dev/shm/tsim/services_registry.json"
    },
    "quick_select_services": [
        {"ports": "25/tcp,587/tcp,465/tcp,110/tcp,995/tcp,143/tcp,993/tcp", "name": "Email Services", "description": "SMTP, POP3, IMAP (all ports)"},
        {"ports": "20/tcp,21/tcp,22/tcp", "name": "FTP/SFTP Services", "description": "FTP control, data, and SFTP"},
        {"ports": "80/tcp,443/tcp,8080/tcp,8443/tcp", "name": "Web Services", "description": "HTTP/HTTPS (standard and alternate)"},
        {"ports": "53/tcp,53/udp", "name": "DNS Services", "description": "Domain Name System (TCP and UDP)"},
        {"ports": "88/tcp,88/udp,464/tcp,464/udp", "name": "Kerberos Services", "description": "Kerberos auth and password change"},
        {"ports": "389/tcp,389/udp,636/tcp,3268/tcp,3269/tcp", "name": "LDAP/AD Services", "description": "LDAP, LDAPS, Global Catalog"},
        {"ports": "135/tcp,139/tcp,445/tcp", "name": "Windows File Sharing", "description": "RPC, NetBIOS, SMB"},
        {"ports": "3306/tcp,5432/tcp,1433/tcp,1521/tcp", "name": "Database Services", "description": "MySQL, PostgreSQL, MSSQL, Oracle"},
        {"ports": "3389/tcp,5985/tcp,5986/tcp", "name": "Remote Management", "description": "RDP, WinRM (HTTP/HTTPS)"},
        {"ports": "22/tcp", "name": "SSH", "description": "Secure Shell"},
        {"ports": "23/tcp", "name": "Telnet", "description": "Telnet (insecure)"},
        {"ports": "25/tcp", "name": "SMTP", "description": "Mail submission"},
        {"ports": "53/udp", "name": "DNS", "description": "Domain Name System"},
        {"ports": "67/udp,68/udp", "name": "DHCP", "description": "Dynamic Host Configuration"},
        {"ports": "69/udp", "name": "TFTP", "description": "Trivial File Transfer"},
        {"ports": "80/tcp", "name": "HTTP", "description": "Web Traffic"},
        {"ports": "110/tcp", "name": "POP3", "description": "Post Office Protocol"},
        {"ports": "123/udp", "name": "NTP", "description": "Network Time Protocol"},
        {"ports": "137/udp,138/udp", "name": "NetBIOS", "description": "NetBIOS Name/Datagram Service"},
        {"ports": "143/tcp", "name": "IMAP", "description": "Internet Message Access"},
        {"ports": "161/udp,162/udp", "name": "SNMP", "description": "Simple Network Management"},
        {"ports": "443/tcp", "name": "HTTPS", "description": "Secure Web"},
        {"ports": "445/tcp", "name": "SMB", "description": "Server Message Block"},
        {"ports": "514/udp", "name": "Syslog", "description": "System Logging"},
        {"ports": "587/tcp", "name": "SMTP-Submission", "description": "Mail submission (authenticated)"},
        {"ports": "636/tcp", "name": "LDAPS", "description": "Secure LDAP"},
        {"ports": "873/tcp", "name": "Rsync", "description": "File synchronization"},
        {"ports": "993/tcp", "name": "IMAPS", "description": "Secure IMAP"},
        {"ports": "995/tcp", "name": "POP3S", "description": "Secure POP3"},
        {"ports": "1433/tcp", "name": "MSSQL", "description": "Microsoft SQL Server"},
        {"ports": "1521/tcp", "name": "Oracle", "description": "Oracle Database"},
        {"ports": "1723/tcp", "name": "PPTP", "description": "Point-to-Point Tunneling"},
        {"ports": "2049/tcp,2049/udp", "name": "NFS", "description": "Network File System"},
        {"ports": "3306/tcp", "name": "MySQL", "description": "MySQL Database"},
        {"ports": "3389/tcp", "name": "RDP", "description": "Remote Desktop"},
        {"ports": "5060/tcp,5060/udp,5061/tcp", "name": "SIP", "description": "Session Initiation Protocol"},
        {"ports": "5432/tcp", "name": "PostgreSQL", "description": "PostgreSQL Database"},
        {"ports": "5900/tcp", "name": "VNC", "description": "Virtual Network Computing"},
        {"ports": "6379/tcp", "name": "Redis", "description": "Redis Database"},
        {"ports": "8080/tcp", "name": "HTTP-Alt", "description": "Alternate Web"},
        {"ports": "8443/tcp", "name": "HTTPS-Alt", "description": "Alternate Secure Web"},
        {"ports": "9200/tcp,9300/tcp", "name": "Elasticsearch", "description": "Elasticsearch HTTP/Transport"},
        {"ports": "11211/tcp", "name": "Memcached", "description": "Memory Cache Daemon"},
        {"ports": "27017/tcp", "name": "MongoDB", "description": "MongoDB Database"}
    ],
    
    "wsgi_processes": 4,
    "wsgi_threads": 2,
    "wsgi_max_requests": 1000,
    "wsgi_request_timeout": 300,
    "wsgi_socket_timeout": 60,
    "wsgi_preload_modules": [
        "tsim_application",
        "services.tsim_config_service",
        "services.tsim_session_manager",
        "services.tsim_logger_service"
    ],

    "wsgi_execution_mode": "serial",
    "wsgi_parallel_config": {
        "max_quick_jobs": 32,
        "thread_pool_workers": 33,
        "enable_fallback_to_serial": true,
        "log_execution_metrics": true
    },

    "data_dir": "/dev/shm/tsim",
    "log_dir": "/var/log/tsim",
    "session_dir": "/dev/shm/tsim/sessions",
    "run_dir": "/dev/shm/tsim/runs",
    "scripts_dir": "/dev/shm/tsim/scripts",
    "cache_dir": "/dev/shm/tsim/pycache",
    "matplotlib_cache_dir": "/dev/shm/tsim/matplotlib",
    "lock_dir": "/dev/shm/tsim/locks",
    "users_file": "/opt/tsim/wsgi/conf/users.json",
    "web_root": "/opt/tsim/wsgi",
    
    "max_services": 10,
    "max_trace_hops": 30,
    "trace_timeout": 120,
    "reachability_timeout": 120,
    "pdf_timeout": 300,
    "cleanup_age": 86400,
    
    "hmac_expiry": 86400,
    
    "dscp_registry": {
        "enabled": true,
        "dscp_range_min": 32,
        "dscp_range_max": 63,
        "max_concurrent_jobs": 32,
        "allocation_timeout": 3600,
        "cleanup_interval": 300
    },

    "registry_manager": {
        "enabled": true,
        "lock_timeouts": {
            "host_registry": 5.0,
            "host_leases": 3.0,
            "router_lock": 30.0,
            "router_lock_atomic": 60.0,
            "neighbor_leases": 3.0
        },
        "retry_attempts": 3,
        "retry_delay": 0.1,
        "enable_transaction_log": false,
        "transaction_log_path": null
    },

    "ksms_parallel_execution": true,
    "max_parallel_fast_jobs": 8,
    
    "ksms_enabled": true,
    "ksms_mode_default": "quick",
    "ksms_timeout": 300,

    "cors": {
        "enabled": false,
        "allowed_origins": ["*"],
        "allowed_methods": ["GET", "POST"],
        "allowed_headers": ["Content-Type", "Authorization"]
    }
}
